% FMO Ford-Fulkerson summary 2017
% tree reconstruct: 0, normalized: 0, method: 0
%  tree reconstruct: 0, normalized: 0, method: 0
 G_000 = {% data = [ 0.922000 1.357000 1.563000 1.664000 3.212000 3.632000 3.866000 ] 
{[8 6 3 ] [7 5 4 2 1 ] } 
{[8 ] [6 3 ] [7 5 4 2 1 ] } 
{[8 ] [6 3 ] [7 5 4 2 1 ] } 
{[8 ] [6 3 ] [7 5 4 2 ] [1 ] } 
{[8 ] [6 3 ] [7 5 4 2 ] [1 ] } 
{[8 ] [6 ] [3 ] [7 5 4 2 ] [1 ] } 
{[8 ] [6 ] [3 ] [7 ] [5 ] [4 ] [2 ] [1 ] } 
};

%  tree reconstruct: 0, normalized: 0, method: 1
 G_001 = {% data = [ 64.00 32.00 16.00 8.00 4.00 2.00 1.00 ];
{[8 ] [6 ] [3 ] [7 5 4 2 ] [1 ] } 
{[8 ] [6 ] [3 ] [7 5 4 2 ] [1 ] } 
{[8 ] [6 ] [3 ] [7 5 4 2 ] [1 ] } 
{[8 ] [6 ] [3 ] [7 5 4 2 ] [1 ] } 
{[8 ] [6 ] [3 ] [7 5 4 2 ] [1 ] } 
{[8 ] [6 3 ] [7 5 4 2 ] [1 ] } 
{[8 6 3 ] [7 5 4 2 1 ] } 
};

%  tree reconstruct: 0, normalized: 0, method: 2
 G_002 = {% data = [ 0.922000 1.357000 1.563000 1.664000 3.212000 3.632000 3.866000 ] 
{[3 6 8 ] [7 5 4 2 1 ] } 
{[3 6 ] [7 5 4 2 1 ] [8 ] } 
{[3 6 ] [7 4 2 1 ] [8 ] [5 ] } 
{[3 6 ] [7 4 2 ] [8 ] [5 ] [1 ] } 
{[3 6 ] [7 2 ] [8 ] [5 ] [1 ] [4 ] } 
{[6 ] [7 2 ] [8 ] [5 ] [1 ] [4 ] [3 ] } 
{[6 ] [7 ] [8 ] [5 ] [1 ] [4 ] [3 ] [2 ] } 
};

%  tree reconstruct: 0, normalized: 1, method: 0
 G_010 = {% data = [ 0.061467 0.416000 0.678500 1.288667 1.563000 1.606000 3.632000 ] 
{[8 6 3 ] [7 5 4 2 1 ] } 
{[8 6 3 ] [7 5 4 2 ] [1 ] } 
{[8 ] [6 3 ] [7 5 4 2 ] [1 ] } 
{[8 ] [6 3 ] [7 5 4 ] [2 ] [1 ] } 
{[8 ] [6 3 ] [7 5 4 ] [2 ] [1 ] } 
{[8 ] [6 3 ] [7 ] [5 ] [4 ] [2 ] [1 ] } 
{[8 ] [6 ] [3 ] [7 ] [5 ] [4 ] [2 ] [1 ] } 
};

%  tree reconstruct: 0, normalized: 1, method: 1
 G_011 = {% data = [ 64.00 32.00 16.00 8.00 4.00 2.00 1.00 ];
{[8 ] [6 ] [3 ] [7 5 4 2 ] [1 ] } 
{[8 ] [6 ] [3 ] [7 5 4 2 ] [1 ] } 
{[8 ] [6 ] [3 ] [7 5 4 2 ] [1 ] } 
{[8 6 3 ] [7 5 4 2 ] [1 ] } 
{[8 6 3 ] [7 5 4 2 1 ] } 
{[8 6 3 ] [7 5 4 2 1 ] } 
{[8 6 3 ] [7 5 4 2 1 ] } 
};

%  tree reconstruct: 0, normalized: 1, method: 2
 G_012 = {% data = [ 0.061467 0.416000 0.678500 1.288667 1.563000 1.606000 3.632000 ] 
{[1 2 4 5 7 ] [8 6 3 ] } 
{[2 4 5 7 ] [8 6 3 ] [1 ] } 
{[2 4 5 7 ] [6 3 ] [1 ] [8 ] } 
{[4 5 7 ] [6 3 ] [1 ] [8 ] [2 ] } 
{[4 7 ] [6 3 ] [1 ] [8 ] [2 ] [5 ] } 
{[7 ] [6 3 ] [1 ] [8 ] [2 ] [5 ] [4 ] } 
{[7 ] [6 ] [1 ] [8 ] [2 ] [5 ] [4 ] [3 ] } 
};

%  tree reconstruct: 1, normalized: 0, method: 0
 G_100 = {% data = [ 0.922000 1.357000 1.563000 1.664000 3.212000 3.632000 3.866000 ] 
{[8 6 3 ] [7 2 4 1 5 ] } 
{[8 ] [6 3 ] [7 2 4 1 5 ] } 
{[8 ] [6 3 ] [7 2 4 1 ] [5 ] } 
{[8 ] [6 3 ] [7 2 4 ] [1 ] [5 ] } 
{[8 ] [6 3 ] [7 2 ] [4 ] [1 ] [5 ] } 
{[8 ] [6 ] [3 ] [7 2 ] [4 ] [1 ] [5 ] } 
{[8 ] [6 ] [3 ] [7 ] [2 ] [4 ] [1 ] [5 ] } 
};

%  tree reconstruct: 1, normalized: 0, method: 1
 G_101 = {% data = [ 64.00 32.00 16.00 8.00 4.00 2.00 1.00 ];
{[8 ] [6 ] [3 ] [7 2 4 1 ] [5 ] } 
{[8 ] [6 ] [3 ] [7 2 4 1 ] [5 ] } 
{[8 ] [6 ] [3 ] [7 2 4 1 ] [5 ] } 
{[8 ] [6 ] [3 ] [7 2 4 1 ] [5 ] } 
{[8 ] [6 ] [3 ] [7 2 4 1 ] [5 ] } 
{[8 ] [6 3 ] [7 2 4 1 ] [5 ] } 
{[8 6 3 ] [7 2 4 1 5 ] } 
};

%  tree reconstruct: 1, normalized: 0, method: 2
 G_102 = {% data = [ 0.922000 1.357000 1.563000 1.664000 3.212000 3.632000 3.866000 ] 
{[3 6 8 ] [7 2 4 1 5 ] } 
{[3 6 ] [7 2 4 1 5 ] [8 ] } 
{[3 6 ] [7 2 4 1 ] [8 ] [5 ] } 
{[3 6 ] [7 2 4 ] [8 ] [5 ] [1 ] } 
{[3 6 ] [7 2 ] [8 ] [5 ] [1 ] [4 ] } 
{[6 ] [7 2 ] [8 ] [5 ] [1 ] [4 ] [3 ] } 
{[6 ] [7 ] [8 ] [5 ] [1 ] [4 ] [3 ] [2 ] } 
};

%  tree reconstruct: 1, normalized: 1, method: 0
 G_110 = {% data = [ 0.061467 0.390750 0.554667 0.678500 1.606000 3.632000 3.866000 ] 
{[8 6 3 ] [7 2 4 1 5 ] } 
{[8 6 3 ] [7 2 4 1 ] [5 ] } 
{[8 6 3 ] [7 2 4 ] [1 ] [5 ] } 
{[8 ] [6 3 ] [7 2 4 ] [1 ] [5 ] } 
{[8 ] [6 3 ] [7 2 ] [4 ] [1 ] [5 ] } 
{[8 ] [6 ] [3 ] [7 2 ] [4 ] [1 ] [5 ] } 
{[8 ] [6 ] [3 ] [7 ] [2 ] [4 ] [1 ] [5 ] } 
};

%  tree reconstruct: 1, normalized: 1, method: 1
 G_111 = {% data = [ 64.00 32.00 16.00 8.00 4.00 2.00 1.00 ];
{[8 ] [6 ] [3 ] [7 2 4 1 ] [5 ] } 
{[8 ] [6 ] [3 ] [7 2 4 1 ] [5 ] } 
{[8 ] [6 ] [3 ] [7 2 4 1 ] [5 ] } 
{[8 6 3 ] [7 2 4 1 ] [5 ] } 
{[8 6 3 ] [7 2 4 1 5 ] } 
{[8 6 3 ] [7 2 4 1 5 ] } 
{[8 6 3 ] [7 2 4 1 5 ] } 
};

%  tree reconstruct: 1, normalized: 1, method: 2
 G_112 = {% data = [ 0.061467 0.390750 0.554667 0.678500 1.606000 3.632000 3.866000 ] 
{[1 2 4 5 7 ] [8 6 3 ] } 
{[1 2 4 7 ] [8 6 3 ] [5 ] } 
{[2 4 7 ] [8 6 3 ] [5 ] [1 ] } 
{[2 4 7 ] [6 3 ] [5 ] [1 ] [8 ] } 
{[2 7 ] [6 3 ] [5 ] [1 ] [8 ] [4 ] } 
{[2 7 ] [6 ] [5 ] [1 ] [8 ] [4 ] [3 ] } 
{[7 ] [6 ] [5 ] [1 ] [8 ] [4 ] [3 ] [2 ] } 
};

G = {G_000 G_001 G_002 G_010 G_011 G_012 G_100 G_101 G_102 G_110 G_111 G_112 };
%% rate matrix
% LHCII monomer
R = dlmread('data/FMO.K');
% change unit from fs^-1 to ps^-1
R = R*1000;
R(R<0)=0;

% modified Rate matrix
for i = 1:size(R,1)
    R(i,i) = 0;
end
for i = 1:size(R,1)
    R(i,i) = -sum(R(:,i));
end

%% eigenvector
H = load('data/FMO.H');
[Eigenv,EVal] = eig(H);
eigen_energy=diag(EVal);

%%

cost={};
R_F={};
for i = 1:length(G)
    for j=1:length(G{i})
        [cost{i}(j),R_F{i}{j}] = plot_LHCII_cluster(G{i}{j},H,R);
        close all;
    end
end
%%
figure;hold on;
for i = 1:6
    x_data = [];
    for j = 1:length(G{i})
        x_data(j) = length(G{i}{j});
    end
    plot(x_data,cost{i},'o-','Linewidth',3);

end
xlabel('number of clusters');
ylabel('cost');
legend('SC', 'SR', 'EC', 'norm-SC', 'norm-SR', 'norm-EC');
hold off;
%%
% figure;hold on;
label = {'000', '001', '002', '010', '011', '012', '100', '101', '102', '110', '111', '112'};
for i = 1:6
    fig=figure;
    x_data = [];
    for j = 1:length(G{i})
        x_data(j) = length(G{i}{j});
    end
    plot(x_data,cost{i},'o-','Linewidth',3);
    xlabel('number of clusters');
    ylabel('cost');
    legend(label{i});
    saveas(fig,strcat('fmo_',label{i},'.png'));
end
% % legend('000', '001', '002', '010', '011', '012', '100', '101', '102', '110', '111', '112');
% % hold off;